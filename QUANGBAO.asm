
ORG 00H
MAIN:
;KHOI TAO
		CLR P1.0			;OE ,CHO PHEP
		CLR	 P1.1			;ST_CP ,SAN SANG
		CLR  P1.2			;SH_CP ,SAN SANG
		MOV DPTR,#THI
		
		
BEGIN:	MOV R2,#0
		MOV R3,#0
		MOV R6,#0
		MOV R7,#0
SHIFT:
		MOV R5,#8
		MOV A,R3
		MOVC A,@A+DPTR
REP_SHIF:
		RLC A
		MOV P1.3,C
		CALL CLOCK_W
		DJNZ R5,REP_SHIF
		MOV R5,#8
		INC R6
		CJNE R6,#4,CONT_DATA
		MOV R6,#0
		JMP DISP_DATA
CONT_DATA:
		MOV A,R3
		ADD A,#8
		MOV R3,A
		JMP SHIFT
DISP_DATA:
		CALL CLOCK_D
		CALL ROWS
		CALL DELAY10M
		CLR P1.7
		INC R2
		INC R7
		MOV A,R7
		MOV R3,A
		CJNE R2,#8,SHIFT
		MOV R2,#0
		JMP BEGIN
		
			
		
		
		
		
		
		
		
		
ROWS:	
		MOV A,R2
		CJNE A,#0,ROW2
		CLR P1.4
		CLR P1.5
		CLR P1.6
		SETB P1.7
		JMP END_ROW
ROW2:
		CJNE A,#1,ROW3
		SETB P1.4
		CLR P1.5
		CLR P1.6
		SETB P1.7
		JMP END_ROW
ROW3:
		CJNE A,#2,ROW4
		CLR P1.4
		SETB P1.5
		CLR P1.6
		SETB P1.7
		JMP END_ROW
ROW4:
		CJNE A,#3,ROW5
		SETB P1.4
		SETB P1.5
		CLR P1.6
		SETB P1.7
		JMP END_ROW
ROW5:
		CJNE A,#4,ROW6
		CLR P1.4
		CLR P1.5
		SETB P1.6
		SETB P1.7
		JMP END_ROW
ROW6:
		CJNE A,#5,ROW7
		SETB P1.4
		CLR P1.5
		SETB P1.6
		SETB P1.7
		JMP END_ROW
ROW7:
		CJNE A,#6,ROW8
		CLR P1.4
		SETB P1.5
		SETB P1.6
		SETB P1.7
		JMP END_ROW
ROW8:
		CJNE A,#7,END_ROW
		SETB P1.4
		SETB P1.5
		SETB P1.6
		SETB P1.7
END_ROW:
		RET

CLOCK_D:
		SETB P1.1
		NOP
		CLR P1.1
		RET
CLOCK_W:
		SETB P1.2
		NOP
		CLR P1.2
		RET
DELAY10M:
		PUSH 0
		PUSH 1
		MOV R0,#30
REP_DELAY10M:
		MOV R1,#100
		DJNZ R1,$
		DJNZ R0,REP_DELAY10M
		POP 1
		POP 0
		RET

THI:
db 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 00h    ;Ma Ma Tran

db 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh    ;Ma Ma Tran

db 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh    ;Ma Ma Tran

db 00h, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh, 07Eh    ;Ma Ma Tran



		END
	
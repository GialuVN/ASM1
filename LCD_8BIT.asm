;DINH NGHIA
RS BIT P3.4          ;RS=0 TRUY XUAT THANH GHI LENH (IR),RS=1 TRUY XUAT THANH GHI DU LIEU (DR)
RW BIT P3.3          ;RW=0 LCD O CHE DO GHI             , RW =1 LCD O CHE DO DOC
EN BIT P3.2          ;E CHOT DU LIEU (XUNG TU CAO XUONG THAP_)
BS BIT P1.7          ;KIEM TRA CO BAN(BUSY FLAG)


ORG 00H
;KHOI TAO 
SETB EN
;BAT DAU CHUNG TRINH CHINH
MAIN:
	CALL DELAY50M
	MOV A,#38H
	CALL CMD
	MOV A,#0EH
	CALL CMD
	MOV A,#"A"
	CALL WIRTE
	MOV A,#"B"
	CALL WIRTE
	MOV DPTR,#TV
	MOV R0,#7
	MOV R1,#40H
L_WIRTE:
	MOV A,R1
	CALL CMD
	INC R1
	MOV A,#0
	MOVC A,@A+DPTR
	ANL A,#00011111B
	SETB ACC.6
	CALL WIRTE
	INC DPTR
	DJNZ R0,L_WIRTE
	CALL DELAY50M
	MOV A,#88H
	CALL CMD
	MOV A,#0
	CALL WIRTE
	JMP $


















;XUAT LENH DIEU KHIEN (TRUY XUAT THANH GHI IR)
CMD:
	CALL BUSY
	MOV P1,A
	CLR RS      ;RS=0
	CLR RW		;RW=0
	CLR EN
	SETB EN
	RET
;KIEM TRA CO BAN
BUSY:
	SETB BS		
	CLR RS		;RS=0
	SETB RW     ;RW=1
L_BUSY:
	CLR EN
	SETB EN
	JB BS,L_BUSY
	RET
;GHI DU LIEU VAO DR/CG
WIRTE:
	CALL BUSY
	MOV P1,A
	SETB RS		;RS=1
	CLR RW		;RW=0
	CLR EN
	SETB EN
	RET
;DOC DU LIEU TU DR/CG
READ:
	CALL BUSY
	MOV P1,A
	SETB RS		;RS=1
	SETB RW     ;RW=1
	CLR EN
	SETB EN
	RET
;TRE 50MS
DELAY50M:
	PUSH 01H
	PUSH 00H
	MOV R0,#200
L_DELAY50M:
	MOV R1,#250
	DJNZ R1,$
	DJNZ R0,L_DELAY50M
	POP 00H
	POP 01H
	RET
;TRE 255uS
DELAY255:
	PUSH 00H
	MOV R0,#255
	DJNZ R0,$
	POP 00H
	RET
	
	
	
	
	
	
TV:
db 00h, 0Ch, 012h, 024h, 012h, 0Ch, 00h, 00h    ;Ma Ma Tran

	
	END
	